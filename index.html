<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Gator - Florida Man News Feed</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="manifest" href="/dailygator/manifest.json">
    <meta name="theme-color" content="#FAF9F5">
    <link rel="apple-touch-icon" href="/dailygator/icons/icon-192x192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    
    <style>
@import url('https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&family=Carter+One&display=swap');

:root {
    --florida-green: #0e6e3a;
    --florida-light-green: #10b981;
    --florida-orange: #f97316;
    --florida-yellow: #fbbf24;
    --florida-light: #f9fafb;
    --florida-cream: #fef3c7;
}

body {
    font-family: 'Rubik', sans-serif;
    background-color: #f0fdfa;
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2310b981' fill-opacity='0.07'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

main {
    flex: 1;
}

.brand-font {
    font-family: 'Carter One', cursive;
}

.card {
    transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
    border-radius: 0.75rem;
    background-color: white;
    overflow: hidden;
    box-shadow: 
        0 1px 3px 0 rgba(0, 0, 0, 0.1), 
        0 1px 2px 0 rgba(0, 0, 0, 0.06);
    border: 1px solid rgba(0, 0, 0, 0.08);
    position: relative;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent);
    z-index: 1;
}

.card:hover {
    transform: translateY(-3px);
    box-shadow: 
        0 4px 25px -5px rgba(0, 0, 0, 0.1),
        0 10px 10px -5px rgba(0, 0, 0, 0.04);
    border-color: rgba(16, 185, 129, 0.2);
}

.tab-active {
    background: linear-gradient(180deg, var(--florida-green) 0%, #0a5d32 100%);
    color: white;
    font-weight: 600;
    border-bottom: 3px solid #064e2b;
    position: relative;
    box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.2),
        0 2px 4px rgba(0, 0, 0, 0.1);
}

.tab-active::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 0; 
    height: 0; 
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid #064e2b;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.1));
}

.tab-inactive {
    background: linear-gradient(180deg, #f9fafb 0%, #e5e7eb 100%);
    color: #4b5563;
    font-weight: 500;
    border-bottom: 3px solid transparent;
    box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.8),
        0 1px 3px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.1);
}

.tab-inactive:hover {
    background: linear-gradient(180deg, #f3f4f6 0%, #d1d5db 100%);
    color: #1f2937;
    box-shadow: 
        inset 0 1px 0 rgba(255, 255, 255, 0.8),
        0 2px 4px rgba(0, 0, 0, 0.08);
}

.location-tag {
    background: linear-gradient(135deg, var(--florida-orange) 0%, #ea580c 100%);
    color: white;
    padding: 0.375rem 0.875rem;
    border-radius: 9999px;
    font-weight: 600;
    font-size: 0.75rem;
    display: inline-block;
    box-shadow: 
        0 1px 3px rgba(0, 0, 0, 0.12),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    border: 1px solid rgba(0, 0, 0, 0.1);
}

.action-button {
    background: linear-gradient(180deg, var(--florida-green) 0%, #0a5d32 100%);
    color: white;
    font-weight: 600;
    transition: all 0.2s cubic-bezier(0.2, 0, 0, 1);
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 
        0 2px 4px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(0, 0, 0, 0.1);
    position: relative;
    overflow: hidden;
}

.action-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.action-button:hover::before {
    left: 100%;
}

.action-button:hover {
    background: linear-gradient(180deg, #10b981 0%, var(--florida-green) 100%);
    transform: translateY(-1px);
    box-shadow: 
        0 4px 8px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.action-button:active {
    transform: translateY(0);
    box-shadow: 
        0 2px 4px rgba(0, 0, 0, 0.1),
        inset 0 2px 4px rgba(0, 0, 0, 0.1);
}

.florida-gradient {
    background: linear-gradient(90deg, var(--florida-green) 0%, var(--florida-light-green) 100%);
}

.story-date {
    font-size: 0.875rem;
    color: #6b7280;
    font-weight: 500;
}

.story-title {
    font-weight: 700;
    color: #111827;
    line-height: 1.3;
}

.story-preview {
    color: #4b5563;
    line-height: 1.5;
}

/* Loading skeleton animation */
.loading-pulse {
    animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.5;
    }
}

/* Alligator background for empty states */
.gator-pattern {
    background-color: #f0fdfa;
    background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%2310b981' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.06);
    border: 1px solid rgba(16, 185, 129, 0.2);
}

/* Toast notifications */
.toast {
    position: fixed;
    bottom: 1rem;
    right: 1rem;
    padding: 0.875rem 1.25rem;
    border-radius: 0.75rem;
    color: white;
    box-shadow: 
        0 10px 25px -5px rgba(0, 0, 0, 0.15),
        0 4px 6px -2px rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    z-index: 50;
    opacity: 0;
    transform: translateY(1rem);
    animation: toast-in-out 3s ease forwards;
    border: 1px solid rgba(0, 0, 0, 0.1);
}

@keyframes toast-in-out {
    0% {
        opacity: 0;
        transform: translateY(1rem);
    }
    10% {
        opacity: 1;
        transform: translateY(0);
    }
    90% {
        opacity: 1;
        transform: translateY(0);
    }
    100% {
        opacity: 0;
        transform: translateY(1rem);
    }
}

.bookmark-btn {
    color: #9ca3af;
    transition: all 0.2s cubic-bezier(0.2, 0, 0, 1);
    padding: 0.5rem;
    border-radius: 0.375rem;
    border: 1px solid transparent;
}

.bookmark-btn:hover {
    color: var(--florida-orange);
    transform: scale(1.1);
    background-color: rgba(249, 115, 22, 0.1);
    border-color: rgba(249, 115, 22, 0.2);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.bookmark-btn.active {
    color: var(--florida-orange);
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.1), rgba(234, 88, 12, 0.15));
    border-color: rgba(249, 115, 22, 0.3);
    box-shadow: 
        0 2px 4px rgba(249, 115, 22, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.read-more {
    color: var(--florida-green);
    font-weight: 600;
    transition: all 0.2s cubic-bezier(0.2, 0, 0, 1);
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    border: 1px solid transparent;
}

.read-more:hover {
    color: #064e2b;
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(14, 110, 58, 0.15));
    border-color: rgba(16, 185, 129, 0.3);
    box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);
    text-decoration: none;
}

.card-border {
    border-top: 1px solid #f3f4f6;
    position: relative;
}

.card-border::before {
    content: '';
    position: absolute;
    top: -1px;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent);
}

/* Sticky Footer */
.site-footer {
    margin-top: auto;
    padding: 1.5rem 0;
    background: linear-gradient(180deg, rgba(240, 253, 250, 0.9) 0%, rgba(240, 253, 250, 0.95) 100%);
    border-top: 1px solid #d1fae5;
    backdrop-filter: blur(8px);
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
}

/* Enhanced loading states */
.loading-pulse {
    background: linear-gradient(90deg, #f3f4f6 25%, #e5e7eb 50%, #f3f4f6 75%);
    background-size: 200% 100%;
    animation: loading-shimmer 1.5s infinite;
}

@keyframes loading-shimmer {
    0% {
        background-position: -200% 0;
    }
    100% {
        background-position: 200% 0;
    }
}

/* Navigation enhancements */
nav .flex {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.08);
}

/* Header button enhancement */
header .action-button {
    font-size: 0.95rem;
    letter-spacing: 0.025em;
}

/* Feature cards enhancement */
.card p {
    line-height: 1.6;
}

.card h3 {
    font-weight: 700;
    letter-spacing: -0.025em;
}

/* Icon enhancements */
.fas, .far {
    filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1));
}
    </style>
    
</head>
<body>
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <header class="mb-8 text-center">
            <div class="mb-4">
                <img src="/dailygator/logo.png" alt="Daily Gator Logo" class="h-24 mx-auto">
            </div>
            <p class="text-gray-600 text-lg">Headlines that bite!</p>
            <div class="mt-6">
                <button id="refresh-btn" class="action-button flex items-center mx-auto">
                    <span id="notification-badge" class="hidden inline-block bg-yellow-400 text-xs text-black font-bold rounded-full px-2 py-1 mr-2">New!</span>
                    <i class="fas fa-sync-alt mr-2"></i> Refresh Feed
                </button>
            </div>
        </header>
        
        <nav class="mb-8">
            <div class="flex justify-between rounded-xl overflow-hidden shadow-md">
                <button id="news-tab" class="flex-1 py-3.5 px-4 tab-active transition-all duration-200 text-center">
                    <i class="fas fa-newspaper mr-2"></i> News Feed
                </button>
                <button id="saved-tab" class="flex-1 py-3.5 px-4 tab-inactive transition-all duration-200 text-center">
                    <i class="fas fa-bookmark mr-2"></i> Saved
                </button>
                <button id="features-tab" class="flex-1 py-3.5 px-4 tab-inactive transition-all duration-200 text-center">
                    <i class="fas fa-star mr-2"></i> Features
                </button>
            </div>
        </nav>
        
        <div id="coming-soon-message" class="hidden mb-6 p-4 bg-yellow-50 text-yellow-800 rounded-xl border border-yellow-200 text-center">
            Feature coming soon! Currently developing the main news feed.
        </div>
        
        <main>
            <div id="stories-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Loading placeholders -->
                <div class="card loading-pulse p-5">
                    <div class="h-6 bg-gray-200 rounded w-3/4 mb-3"></div>
                    <div class="h-4 bg-gray-200 rounded mb-2"></div>
                    <div class="h-4 bg-gray-200 rounded w-5/6 mb-2"></div>
                    <div class="h-4 bg-gray-200 rounded w-4/6"></div>
                </div>
                <div class="card loading-pulse p-5">
                    <div class="h-6 bg-gray-200 rounded w-2/3 mb-3"></div>
                    <div class="h-4 bg-gray-200 rounded mb-2"></div>
                    <div class="h-4 bg-gray-200 rounded w-5/6 mb-2"></div>
                    <div class="h-4 bg-gray-200 rounded w-3/4"></div>
                </div>
                <div class="card loading-pulse p-5">
                    <div class="h-6 bg-gray-200 rounded w-4/5 mb-3"></div>
                    <div class="h-4 bg-gray-200 rounded mb-2"></div>
                    <div class="h-4 bg-gray-200 rounded w-5/6 mb-2"></div>
                    <div class="h-4 bg-gray-200 rounded w-2/3"></div>
                </div>
            </div>
        </main>
    </div>
    
    <footer class="site-footer text-center text-gray-500 text-sm mt-12">
        <div class="container mx-auto">
            <p>© 2025 Daily Gator - Tracking Florida Man since whenever</p>
            <p class="mt-2">No alligators were harmed in the making of this app</p>
        </div>
    </footer>
    
    <script>
        let lastFetchTime = 0;
        let knownStoryIds = new Set();
        let savedStories = JSON.parse(localStorage.getItem('savedStories') || '[]');
        
        // Check online status and update UI accordingly
        function updateOnlineStatus() {
            const statusDisplay = document.createElement('div');
            if (navigator.onLine) {
                statusDisplay.className = 'hidden';
            } else {
                statusDisplay.className = 'bg-yellow-50 text-yellow-800 p-3 fixed bottom-0 w-full text-center border-t border-yellow-100';
                statusDisplay.innerHTML = '<i class="fas fa-wifi-slash mr-2"></i> You are currently offline. Showing cached content.';
            }
            
            // Remove any existing status displays
            const existingStatus = document.querySelector('.fixed.bottom-0');
            if (existingStatus) {
                existingStatus.remove();
            }
            
            document.body.appendChild(statusDisplay);
        }
        
        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);
        updateOnlineStatus(); // Initial check
        
        // Main function to fetch and display stories
        async function fetchStories() {
            try {
                // For GitHub Pages with repository name in URL
                const baseUrl = window.location.hostname === 'localhost' ? '' : '/dailygator';
                const response = await fetch(`${baseUrl}/florida_man_stories.json?t=${new Date().getTime()}`);
                const data = await response.json();
                
                // Debug output - remove in production
                console.log("Fetched data:", data);
                
                // Check for new stories
                let newStoriesCount = 0;
                if (data.stories && Array.isArray(data.stories)) {
                    data.stories.forEach(story => {
                        const storyId = story.link; // Use link as unique ID
                        if (!knownStoryIds.has(storyId)) {
                            newStoriesCount++;
                            knownStoryIds.add(storyId);
                        }
                    });
                    
                    // Show notification badge if there are new stories
                    if (newStoriesCount > 0 && lastFetchTime > 0) {
                        const badge = document.getElementById('notification-badge');
                        badge.textContent = newStoriesCount > 1 ? `${newStoriesCount} New!` : 'New!';
                        badge.classList.remove('hidden');
                    }
                    
                    // Update timestamp
                    lastFetchTime = Date.now();
                    
                    // Display stories
                    displayStories(data.stories);
                } else {
                    // Handle case where stories array is missing or not an array
                    console.error("Invalid data format:", data);
                    displayStories([]);
                }
            } catch (error) {
                console.error('Error fetching stories:', error);
                displayStories([]);
            }
        }
        
        function saveStory(storyId, storyData) {
            if (!savedStories.some(story => story.id === storyId)) {
                savedStories.push({
                    id: storyId,
                    ...storyData
                });
                localStorage.setItem('savedStories', JSON.stringify(savedStories));
                
                // Create a toast notification
                const toast = document.createElement('div');
                toast.className = 'toast bg-green-600';
                toast.innerHTML = `
                    <i class="fas fa-check-circle mr-2"></i>
                    <span>Story saved to favorites!</span>
                `;
                document.body.appendChild(toast);
                
                // Update the bookmark icon
                const bookmarkBtn = document.querySelector(`[data-story-id="${storyId}"]`);
                if (bookmarkBtn) {
                    bookmarkBtn.classList.add('active');
                }
                
                // Remove the toast after animation completes
                setTimeout(() => {
                    toast.remove();
                }, 3000);
            } else {
                // Create a toast notification
                const toast = document.createElement('div');
                toast.className = 'toast bg-yellow-600';
                toast.innerHTML = `
                    <i class="fas fa-exclamation-circle mr-2"></i>
                    <span>This story is already saved!</span>
                `;
                document.body.appendChild(toast);
                
                // Remove the toast after animation completes
                setTimeout(() => {
                    toast.remove();
                }, 3000);
            }
        }
        
        function displayStories(stories) {
            const container = document.getElementById('stories-container');
            container.innerHTML = ''; // Clear loading placeholders
            
            // Debug output
            console.log("Stories to display:", stories);
            
            if (!stories || stories.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full p-8 text-center gator-pattern rounded-xl border border-green-200">
                        <i class="fas fa-newspaper text-5xl text-green-600 mb-4"></i>
                        <h2 class="text-2xl font-bold mb-4 text-gray-800">No Florida Man stories found yet!</h2>
                        <p class="text-gray-600 mb-4">The scraper might still be collecting stories, or Florida Man is taking a day off.</p>
                        <button id="manual-refresh" class="action-button mt-2">
                            <i class="fas fa-sync-alt mr-2"></i> Try Manual Refresh
                        </button>
                    </div>
                `;
                document.getElementById('manual-refresh').addEventListener('click', fetchStories);
                return;
            }
            
            stories.forEach(story => {
                const storyId = story.link; // Use link as unique ID
                const isAlreadySaved = savedStories.some(saved => saved.id === storyId);
                
                const card = document.createElement('div');
                card.className = 'card';
                
                // Extract Florida city or default to "Florida"
                const location = story.location || 'Florida';
                
                card.innerHTML = `
                    <div class="p-5">
                        <span class="location-tag mb-3">${location}</span>
                        <h2 class="story-title text-xl mb-3">${story.title}</h2>
                        <p class="story-preview mb-5">${story.preview || 'Click to read this wild Florida Man story...'}</p>
                        <div class="flex justify-between items-center pt-3 card-border">
                            <span class="story-date">${formatDate(story.date)}</span>
                            <div class="flex items-center">
                                <button class="bookmark-btn mr-4 ${isAlreadySaved ? 'active' : ''}" data-story-id="${storyId}"
                                        onclick='saveStory("${storyId}", ${JSON.stringify(story).replace(/"/g, '&quot;')})'>
                                    <i class="fas fa-bookmark"></i>
                                </button>
                                <a href="${story.link}" target="_blank" class="read-more">
                                    Read <i class="fas fa-arrow-right ml-1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        function formatDate(dateString) {
            if (!dateString) return 'Recently';
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            } catch (e) {
                return 'Recently';
            }
        }
        
        function showSavedStories() {
            const container = document.getElementById('stories-container');
            container.innerHTML = '';
            
            if (savedStories.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'col-span-full p-8 text-center gator-pattern rounded-xl border border-green-200';
                emptyState.innerHTML = `
                    <i class="far fa-folder-open text-5xl text-green-600 mb-4"></i>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">No saved stories yet</h3>
                    <p class="text-gray-600 mb-4">Bookmark Florida Man stories to read them later!</p>
                    <button id="go-to-feed" class="action-button mt-2">
                        <i class="fas fa-newspaper mr-2"></i> Browse News Feed
                    </button>
                `;
                container.appendChild(emptyState);
                document.getElementById('go-to-feed').addEventListener('click', () => {
                    document.getElementById('news-tab').click();
                });
                return;
            }
            
            savedStories.forEach(story => {
                const card = document.createElement('div');
                card.className = 'card';
                
                card.innerHTML = `
                    <div class="p-5">
                        <span class="location-tag mb-3">${story.location || 'Florida'}</span>
                        <h2 class="story-title text-xl mb-3">${story.title}</h2>
                        <p class="story-preview mb-5">${story.preview || 'Click to read this wild Florida Man story...'}</p>
                        <div class="flex justify-between items-center pt-3 card-border">
                            <button class="text-red-500 hover:text-red-600 transition-transform hover:scale-110" onclick="removeFromSaved('${story.id}')">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                            <a href="${story.link}" target="_blank" class="read-more">
                                Read <i class="fas fa-arrow-right ml-1"></i>
                            </a>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        function removeFromSaved(storyId) {
            savedStories = savedStories.filter(story => story.id !== storyId);
            localStorage.setItem('savedStories', JSON.stringify(savedStories));
            
            // Create a toast notification
            const toast = document.createElement('div');
            toast.className = 'toast bg-red-600';
            toast.innerHTML = `
                <i class="fas fa-trash-alt mr-2"></i>
                <span>Story removed from favorites</span>
            `;
            document.body.appendChild(toast);
            
            // Remove the toast after animation completes
            setTimeout(() => {
                toast.remove();
            }, 3000);
            
            showSavedStories(); // Refresh the display
        }
        
        function showFeatures() {
    const container = document.getElementById('stories-container');
    container.innerHTML = `
        <div class="card p-6">
            <div class="flex items-center mb-3">
                <span class="text-pink-500 text-2xl mr-3"><i class="fas fa-calendar-day"></i></span>
                <h3 class="text-xl font-bold text-gray-800">Florida Man Birthday Challenge</h3>
            </div>
            <p class="text-gray-600 mb-3">Find out what Florida Man did on your birthday!</p>
            <div class="bg-gray-100 rounded-lg p-4 mt-4 text-center">
                <p class="text-gray-500">Coming soon</p>
            </div>
        </div>
        
        <div class="card p-6">
            <div class="flex items-center mb-3">
                <span class="text-blue-500 text-2xl mr-3"><i class="fas fa-map-marked-alt"></i></span>
                <h3 class="text-xl font-bold text-gray-800">Florida Heat Map</h3>
            </div>
            <p class="text-gray-600 mb-3">See where the wildest Florida Man stories happen.</p>
            <div class="bg-gray-100 rounded-lg p-4 mt-4 text-center">
                <p class="text-gray-500">Coming soon</p>
            </div>
        </div>
        
        <div class="card p-6">
            <div class="flex items-center mb-3">
                <span class="text-yellow-500 text-2xl mr-3"><i class="fas fa-question-circle"></i></span>
                <h3 class="text-xl font-bold text-gray-800">Florida or Not?</h3>
            </div>
            <p class="text-gray-600 mb-3">Test your Florida Man knowledge with this quiz game.</p>
            <div class="bg-gray-100 rounded-lg p-4 mt-4 text-center">
                <p class="text-gray-500">Coming soon</p>
            </div>
        </div>
        
        <div class="card p-6">
            <div class="flex items-center mb-3">
                <span class="text-purple-500 text-2xl mr-3"><i class="fas fa-trophy"></i></span>
                <h3 class="text-xl font-bold text-gray-800">Florida Man of the Month</h3>
            </div>
            <p class="text-gray-600 mb-3">Vote for the most outrageous Florida Man story.</p>
            <div class="bg-gray-100 rounded-lg p-4 mt-4 text-center">
                <p class="text-gray-500">Coming soon</p>
            </div>
        </div>
        
        <div class="card p-6">
            <div class="flex items-center mb-3">
                <span class="text-cyan-500 text-2xl mr-3"><i class="fas fa-cloud-sun-rain"></i></span>
                <h3 class="text-xl font-bold text-gray-800">Weather Correlation Alerts</h3>
            </div>
            <p class="text-gray-600 mb-3">See how Florida Man activity correlates with weather patterns!</p>
            <div class="bg-gray-100 rounded-lg p-4 mt-4 text-center">
                <p class="text-gray-500">Coming soon</p>
            </div>
        </div>
    `;
}
        
        // Tab navigation
        document.getElementById('news-tab').addEventListener('click', function() {
            document.getElementById('news-tab').className = 'flex-1 py-3.5 px-4 tab-active transition-all duration-200 text-center';
            document.getElementById('saved-tab').className = 'flex-1 py-3.5 px-4 tab-inactive transition-all duration-200 text-center';
            document.getElementById('features-tab').className = 'flex-1 py-3.5 px-4 tab-inactive transition-all duration-200 text-center';
            
            fetchStories(); // Show main news feed
        });
        
    document.getElementById('saved-tab').addEventListener('click', function() {
        document.getElementById('saved-tab').className = 'flex-1 py-3.5 px-4 tab-active transition-all duration-200 text-center';
        document.getElementById('news-tab').className = 'flex-1 py-3.5 px-4 tab-inactive transition-all duration-200 text-center';
        document.getElementById('features-tab').className = 'flex-1 py-3.5 px-4 tab-inactive transition-all duration-200 text-center';
    
            showSavedStories(); // Show saved stories
        });
        
        document.getElementById('features-tab').addEventListener('click', function() {
            document.getElementById('features-tab').className = 'flex-1 py-3.5 px-4 tab-active transition-all duration-200 text-center';
            document.getElementById('news-tab').className = 'flex-1 py-3.5 px-4 tab-inactive transition-all duration-200 text-center';
            document.getElementById('saved-tab').className = 'flex-1 py-3.5 px-4 tab-inactive transition-all duration-200 text-center';
            
            showFeatures(); // Show features menu
        });
        
        // Refresh button functionality
        document.getElementById('refresh-btn').addEventListener('click', function() {
            fetchStories();
            document.getElementById('notification-badge').classList.add('hidden');
        });
        
        // PWA installation
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent Chrome 67 and earlier from automatically showing the prompt
            e.preventDefault();
            // Stash the event so it can be triggered later.
            deferredPrompt = e;
            
            // Show the install button
            const installBanner = document.createElement('div');
            installBanner.className = 'fixed bottom-0 left-0 right-0 bg-green-50 p-4 flex justify-between items-center border-t border-green-200';
            installBanner.innerHTML = `
                <div>
                    <p class="font-bold text-gray-800">Install Daily Gator App</p>
                    <p class="text-sm text-gray-600">Get the latest Florida Man stories offline!</p>
                </div>
                <div class="flex">
                    <button id="install-btn" class="action-button mr-2">
                        <i class="fas fa-download mr-2"></i> Install
                    </button>
                    <button id="close-banner" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg">
                        Not Now
                    </button>
                </div>
            `;
            
            document.body.appendChild(installBanner);
            
            document.getElementById('install-btn').addEventListener('click', async () => {
                // Show the install prompt
                deferredPrompt.prompt();
                // Wait for the user to respond to the prompt
                const { outcome } = await deferredPrompt.userChoice;
                // We've used the prompt, and can't use it again, so drop the reference
                deferredPrompt = null;
                // Hide the install banner
                installBanner.remove();
            });
            
            document.getElementById('close-banner').addEventListener('click', () => {
                installBanner.remove();
            });
        });
        
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // For GitHub Pages with repository name in URL
                const baseUrl = window.location.hostname === 'localhost' ? '' : '/dailygator';
                navigator.serviceWorker.register(`${baseUrl}/service-worker.js`)
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }
        
        // Initial fetch
        fetchStories();
        
        // Set up periodic checks for new content (every 5 minutes)
        setInterval(fetchStories, 5 * 60 * 1000);
    </script>
</body>
</html>
